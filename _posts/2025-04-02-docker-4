---
title: "[STUDY_4] Docker ë°±ì—… ë° ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤ì „ ê°€ì´ë“œ"
date: 2025-04-02 09:00:00 +0900
categories: [Infra_Study]
tags: [Docker, Backup, Migration, ì‹¤ë¬´íŒ]
---

ì•ˆë…•í•˜ì„¸ìš”.  
ì–´ëŠë§ Docker 3í¸ê¹Œì§€ ì™”ìŠµë‹ˆë‹¤.  
ì €ë„ ë„ì»¤ì— ëŒ€í•´ ê³„ì† ê³µë¶€í•˜ê³  ìˆê³  ì¡°ê¸ˆ ë” ììœ ë¡­ê²Œ ë‹¤ë£¨ê¸° ìœ„í•´ì„œ ë…¸ë ¥ì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤.

í˜„ì¬ ì €ëŠ” í”„ë¼ì´ë¹—í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ì„œë²„ë¥¼ ê´€ë¦¬í•˜ê³ ìˆìŠµë‹ˆë‹¤.  
ìµœê·¼ Cent OS EOSë¡œ ì¸í•˜ì—¬ Rocky 8 Linuxë¡œ ì „ë¶€ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ í•˜ê³  ìˆê³   
ì´ ê³¼ì •ì—ì„œ êµ¬ë™ì¤‘ì´ë˜ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ìƒˆë¡œ ì˜¬ë ¤ì•¼ í•˜ëŠ” ìƒí™©ì— ë§ì´í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

ì €ì™€ ê°™ì€ í™˜ê²½ì— ì²˜í•œ ì‚¬ëŒë“¤ì„ ìœ„í•´ **ë„ì»¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ê´€ë ¨ ê°€ì´ë“œë¥¼ ì œê³µ**í•´ë“œë¦¬ê³ ì í•©ë‹ˆë‹¤.  
ë§ˆì´ê·¸ë ˆì´ì…˜ ì´í›„ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì™€ì„œ, ì„œë²„ì— ì»¨í…Œì´ë„ˆë¥¼ êµ¬ë™í•˜ëŠ” `run`ê³¼ `exec` ëª…ë ¹ì–´ëŠ” ì´ì „ì— ë‹¤ë£¨ì—ˆìœ¼ë‹ˆ ì´ë²ˆì—ëŠ”  
**ë„ì»¤ë¥¼ ë°±ì—…í•˜ëŠ” ë°©ë²•ê³¼ ë°±ì—…í•œ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ë“¤**ì„ ë‹¤ë£¨ì–´ë³´ê² ìŠµë‹ˆë‹¤.

---

## âœ… 1. Docker ë°ì´í„° êµ¬ì„±ìš”ì†Œ ì´í•´

- **Docker ì´ë¯¸ì§€ (images)**: ì»¨í…Œì´ë„ˆ ì‹¤í–‰ì˜ ê¸°ë°˜  
- **Docker ì»¨í…Œì´ë„ˆ (containers)**: ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤  
- **Docker ë³¼ë¥¨ (volumes)**: ë°ì´í„°ê°€ ì €ì¥ë˜ëŠ” ê³³ (DB ë“±)  
- **Docker ë„¤íŠ¸ì›Œí¬ (networks)**: ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  êµ¬ì„±  
- **Docker Compose íŒŒì¼**: ì„œë¹„ìŠ¤ ì •ì˜ ìŠ¤í¬ë¦½íŠ¸ (`docker-compose.yml`)

---

## âœ… 2. ì‹¤ì œ ë°±ì—… ì ˆì°¨

### ğŸ§± (1) ì´ë¯¸ì§€ì™€ ì»¨í…Œì´ë„ˆ ëª©ë¡ ì €ì¥

```bash
docker images > docker_images_list.txt
docker ps -a > docker_containers_list.txt
```

### ğŸ“¦ (2) Docker ì´ë¯¸ì§€ ì €ì¥ (ë°±ì—…)

```bash
docker save -o my_image.tar <ì´ë¯¸ì§€ ì´ë¦„>:<íƒœê·¸>
```

### ğŸšš (3) ë³¼ë¥¨ ë°ì´í„° ë°±ì—…

```bash
docker run --rm -v <ë³¼ë¥¨ ì´ë¦„>:/volume -v $(pwd):/backup alpine tar czf /backup/backup.tar.gz -C /volume
```

### ğŸšš (4) docker-compose.yml ë°±ì—…

- Gitì— ìˆëŠ” ê²½ìš°ë„ ë§ìœ¼ë©° ë³µì‚¬í•´ë‘ê¸°ë§Œ í•˜ë©´ ë¨.

> ê°œì¸ì ìœ¼ë¡œ ë‚´ê°€ ì§ì ‘ êµ¬ì¶•í•˜ê³  ì˜µì…˜ì„ ì„¤ì •í•œ ì„œë²„ê°€ ì•„ë‹ˆë¼ë©´  
> **Composeë¡œ ì»¨í…Œì´ë„ˆë¥¼ êµ¬ë™í•˜ëŠ”ê²Œ í›¨ì”¬ ì¢‹ë‹¤**ê³  ìƒê°í•©ë‹ˆë‹¤.

---

## âœ… 3. ìƒˆë¡œìš´ ì„œë²„ì—ì„œ ë³µì› ì ˆì°¨

### ğŸ“¥ (1) ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°

```bash
docker load -i my_image.tar
```

### ğŸ’¾ (2) ë³¼ë¥¨ ë³µì›

```bash
docker volume create <ë³¼ë¥¨ ì´ë¦„>
docker run --rm -v <ë³¼ë¥¨ ì´ë¦„>:/volume -v $(pwd):/backup alpine sh -c "cd /volume && tar xzf /backup/backup.tar.gz"
```

### ğŸš€ (3) ì»¨í…Œì´ë„ˆ ì¬ìƒì„±

```bash
docker-compose up -d
```

> ëŒ€ë¶€ë¶„ ìœ„ì˜ ë°©ë²•ìœ¼ë¡œ ë°±ì—…ë°›ì€ ë„ì»¤ë¥¼ êµ¬ë™ì‹œí‚¤ëŠ”ë° ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.

---

## âœ… 4. Docker Inspect ë°±ì—…

- ì„¤ì • ì •ë³´ ë³´ì¡´ ë° ë””ë²„ê¹…ì— ë§¤ìš° ìœ ìš©í•¨

```bash
docker inspect <ì»¨í…Œì´ë„ˆ ì´ë¦„ ë˜ëŠ” ID> > container_inspect_backup.json
docker inspect --format='{{range .Config.Env}}{{println .}}{{end}}' <ì»¨í…Œì´ë„ˆëª…> > env.txt
```

### ğŸ” ì£¼ë¡œ í™•ì¸í•˜ëŠ” ì •ë³´ë“¤

| í•­ëª© | ì„¤ëª… |
|------|------|
| `Config.Env` | í™˜ê²½ ë³€ìˆ˜ |
| `NetworkSettings.IPAddress` | ì»¨í…Œì´ë„ˆ IP |
| `Mounts` | ë§ˆìš´íŠ¸ ì •ë³´ |
| `State` | ì»¨í…Œì´ë„ˆ ìƒíƒœ |
| `HostConfig.PortBindings` | í¬íŠ¸ ë°”ì¸ë”© |
| `LogPath` | ë¡œê·¸ ê²½ë¡œ |
| `Created` | ìƒì„± ì‹œê°„ |
| `Path / Args` | ì‹¤í–‰ ëª…ë ¹ì–´ |

---

## âœ… 5. ì£¼ì˜ì‚¬í•­

- DB ë“± ì¤‘ìš” ì •ë³´ëŠ” volume tar ë°±ì—… í•„ìˆ˜  
- `docker inspect`ë¡œ ì„¤ì • ì •ë³´ ì €ì¥ ê¶Œì¥  
- ì™ ë§Œí•˜ë©´ `docker save/load` ì‚¬ìš©  
- ë„¤íŠ¸ì›Œí¬ë„ í•„ìš”ì‹œ `docker network inspect` ë°±ì—…  

> ë„ì»¤ ìì²´ë¥¼ ë°±ì—…í•˜ê³  ë‹¤ì‹œ ë¡œë“œí•˜ëŠ” ê²ƒì€ ì–´ë µì§€ ì•Šì§€ë§Œ,  
> ì•ˆì •ì ì¸ ë³µì›ì„ ìœ„í•´ì„œëŠ” í‰ì†Œë¶€í„° **ì£¼ê¸°ì ì¸ ë°±ì—… ìŠµê´€**ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.  
> `crontab`ì„ ì´ìš©í•´ ìë™í™”í•´ë‘ëŠ” ê²ƒë„ ì¶”ì²œí•©ë‹ˆë‹¤.

---

ê°ì‚¬í•©ë‹ˆë‹¤.  
â“’ 2025 ë©©ê¸° ë¸”ë¡œê·¸
